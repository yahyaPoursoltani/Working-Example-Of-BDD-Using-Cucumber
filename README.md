به نام خدا
ایجاد مبتنی بر رفتار - BDD
آزمایشگاه مهندسی نرم افزار - دانشگاه صنعتی شریف
لینک
_________________________________________________________________________________________________________________________________
مقدمه
روش BDD بر رفتار کاربر در سیستم متمرکز است و یکی از مشتقات روش TDD است. تلاش آن بر این است که با استفاده از یک سری ابزار و تکنیک، به درک بهتر نیازمندی‌های مشتری کمک کند. به عنوان مثال، به تصویر زیر توجه کنید : 

فرض کنید که مشتری نیازمندی خود را به نحوی بیان می‌کند و مدیر پروژه بر اساس آن، برداشت شکل زیر را می‌کند : 

سپس مدیر پروژه، برداشت خود را به تیم تحلیل و طراحی منتقل می‌کند و آن‌ها، چنین طراحی را انجام می‌دهند : 

حالا فرض کنید که این مورد به برنامه نویسان منتقل می‌شود و آن‌ها نیز اقدام به پیاده سازی این طرح می‌نمایند!

حتی در عمل ، خیلی از پروژه‌ها فاقد مستندات مناسب از نیازمندی‌ها هستند که در عمل باعث می‌شود که چیزی برای انتقال نیازمندی به تیم ایجاد کنندگان وجود نداشته باشد. حتی ممکن است که کسی که سیستم را تست می‌کند با صحنه زیر دچار شود 🙂

در نهایت، چیزی که پیاده سازی می‌شود، شکل زیر است : 

حال آن که این چیزی که پیاده سازی شده، تفاوت زیادی با نیازمندی مورد نظر مشتری دارد و هیچ یک از اعضای تیم های تحلیل و طراحی و تست و تیم ایجاد نتوانستند به درستی آن را درک کنند. 
نقش‌ها
همان طور که می‌دانیم، در جریان ایجاد نرم افزار نقش‌های مختلفی وجود دارد : 
تحلیلگر سیستم (BA) نظر و خواسته خود را از سیستم بیان می‌کند.
کسی که سیستم را تست می‌کند (Tester) انتظارات خود را از سیستم بیان می‌کند؛ مثلا ممکن است بگوید که با کلیک بر روی یک دکمه چه انتظاراتی را دارد.
ایجاد کننده (Developer) نیز با یک سری کد سر و کار دارد.
رویکرد TDD

به عنوان مثال فرض کنید که در شرکتی بخواهیم یک قابلیت را به یک سیستم اضافه کنیم : 
برای تحلیلگر توضیح می‌دهیم که این سیستم قرار است چه کند؟
تحلیلگر برای ایجاد کنندگان توضیح می‌دهد که سیستم چه باید بکند؟ برای این منظور، درخواست خود را در قالب مجموعه ای از نیازمندی ها طرح میکند و در قالب یک متن صریح (به زبان فارسی یا انگلیسی) در اختیار دو گروه ایجاد کنندگان (Developers) و تسترها (Testers ) قرار می‌دهد.
ایجاد کنندگان (Developers) این درخواست‌ها را دریافت کرده و در قالب یک زبان برنامه نویسی می‌نویسند و همراه آن به منظور استفاده از رویکرد TDD اقدام به نوشتن تعدادی Test Case نیز می‌کنند.
فرد Tester نیز همان مستندات را دریافت کرده و بر مبنای آن اقدام به ایجاد تست کیس‌هایی می‌کند. 
در نهایت محصول نرم افزاری آماده شده و آماده ارائه به مشتری است؛ اما لازم است که نرم افزار ایجاد شده مجددا توسط افراد دیگری مستندسازی شود و با مستندات به مشتری تحویل شود.
روش BDD
این روش برای اولین بار توسط Dan North مطرح شد و تمرکز این روش بر روی رفتار نهایی برنامه از منظر ذینفعان آن است. 

به منظور تحقق این روش، موارد زیر اجرا می‌شود : 
مالک کسب و کار، به تحلیلگر کسب و کار نیازمندی‌ها را توضیح می‌دهد.
بر خلاف روش قبل که در آن مستندات مورد نیاز توسط تحلیلگر کسب و کار (Analyst) تولید میشد و در اختیار تیم های ایجاد و تست قرار می‌گرفت، این بار یک جلسه با حضور هرسه نقش ( 1- مالک کسب و کار 2- تحلیل گر 3- تیم ایجاد و تست) برگزار می‌شود و نیازمندی‌ها مورد بررسی قرار می‌گیرد و تلاش می‌شود که هر سه به یک درک مشترکی از آن برسند. برای این منظور، نیازمندی‌ها در قالب مجموعه ای از سناریوها طرح می‌شوند.
برنامه نویسان از سناریو استفاده می‌کنند تا برنامه‌نویسی و تست های واحد را بر مبنای آن بنویسند.
تیم تست نیز از این سناریوها استفاده کرده و بر مبنای آن، اقدام به نوشتن تست می‌کنند.
در نهایت باید توجه کرد که تست‌های خودکارسازی شده، به عنوان تست‌هایی سطح پایین بر روی محصول اجرا خواهد شد.
مزیت این رویکرد نسبت به رویکرد قبلی : با توجه به این که مبنای کار برای تیم‌ها مبتنی بر سناریو و مثال است ، افراد تیم ها دچار ابهام کمتری خواهند شد و نیازمندی‌ها به صورت بهتری پیاده سازی می‌شوند.
همچنین باعث می‌شود که تست های بهتری برای سیستم نوشته شود.
مقایسه BDD و TDD

در روش TDD بر روی Unit Test تمرکز می‌کنیم؛ برای این منظور آن‌ها را می‌نویسیم و سپس با روش‌های مختلف بازآرایی تلاش می‌کنیم که آن تست ها پاس شوند؛ اما در رویکرد BDD بر خلاف TDD که بر روی تست واحد تمرکز میکردیم، بر روی تست پذیرش (Acceptance Test) تمرکز می‌کنیم و تلاش می‌کنیم که سناریوهای داده شده به درستی اجرا شوند.
در رویکرد BDD ، موارد زیر مد نظر خواهند بود.
نیازمندی ها به عنوان رفتار سیستم در نظر گرفته می‌شوند.
هر رفتار به منزله توصیفی از مشخصاتی از سیستم در نظر گرفته می‌شود و تست سیستم نیز بایستی بر اساس این مشخصات ایجاد شود.
 این نیازمندی‌ها بایستی بر مبنای یک زبان مشترک بیان شده و سپس به کد تبدیل شود.
در نهایت با بازآرایی می‌توان کد را اصلاح کرد.
گام‌های به کارگیری BDD
نیازمندی‌ها را در قالب استوری بیان کنید.
به عنوان نقش می‌خواهم بتوانم کاری را انجام دهم تا مزیت خاصی را بدست آورم.
 نیازمندی را به یک زبان قابل فهم تبدیل کرده تا بتوان بر مبنای آن کد و موارد آزمون را بدست آورد.
بخش Given : بیان مفروضات نیازمندی.
بخش When : شرایط مورد نظر برای برقراری و موضوعیت پیدا کردن نیازمندی.
بخش Then : نتیجه نهایی.
مواردی که با فرمت فوق نوشته شود اصطلاحا فیچرهای ما را تشکیل می‌دهند که در نهایت تبدیل به تست کیس می‌شوند و همچنین می‌توان بر مبنای آن‌ها کدنویسی کرد.
زبان Gherkin 


